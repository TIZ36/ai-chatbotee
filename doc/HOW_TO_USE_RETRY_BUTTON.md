# 如何使用重试按钮

## 📍 按钮位置

重试按钮会显示在**错误消息的右上角**，当消息发送失败时自动出现。

## 🔍 如何看到按钮

### 1. **触发错误消息**

要让重试按钮出现，需要先触发一个错误：

- **网络错误**：断开网络连接后发送消息
- **超时错误**：等待请求超时（10分钟）
- **API错误**：配置错误的API密钥或URL

### 2. **错误消息显示**

当发生错误时，会显示一个**红色背景的错误卡片**，包含：
- ⚠️ 错误图标
- 错误原因
- 排查步骤
- **🔄 重试按钮**（在右上角，蓝色背景）

### 3. **按钮样式**

- **颜色**：蓝色背景（`bg-blue-500`）
- **位置**：消息卡片右上角
- **图标**：旋转箭头（🔄）
- **文字**："重试"

## 🎯 使用步骤

1. **发送消息** → 如果发生网络错误或超时
2. **查看错误消息** → 红色背景的错误卡片
3. **点击"重试"按钮** → 位于右上角
4. **等待重试** → 系统会自动使用相同参数重新发送

## 💡 按钮显示条件

重试按钮**只在以下情况显示**：

✅ **可重试的错误**：
- 网络连接错误
- 请求超时错误
- 5xx 服务器错误
- 429 限流错误

❌ **不可重试的错误**：
- 4xx 客户端错误（如API密钥错误）
- 配置错误
- 其他未知错误

## 🔧 测试方法

### 方法1：模拟网络错误

1. 打开浏览器开发者工具（F12）
2. 切换到 Network 标签
3. 选择 "Offline" 模式
4. 发送一条消息
5. 应该会看到错误消息和重试按钮

### 方法2：修改API配置

1. 在LLM配置中，输入一个错误的API URL
2. 发送消息
3. 应该会看到错误消息（但可能不会显示重试按钮，因为这是配置错误）

### 方法3：等待超时

1. 发送一条消息
2. 等待10分钟（请求超时时间）
3. 应该会看到超时错误和重试按钮

## 📸 按钮外观

```
┌─────────────────────────────────────┐
│ ⚠️  ❌ 错误: 网络连接超时      [🔄 重试] │
│                                      │
│ 🔍 排查步骤：                        │
│ 1. 检查 LLM 模型配置是否正确         │
│ 2. 检查 MCP 服务器是否已连接         │
│ 3. 检查 API 密钥是否有效             │
│ 4. 查看浏览器控制台的详细错误信息    │
└─────────────────────────────────────┘
```

## 🎨 UI特点

- **始终可见**：错误消息的重试按钮不需要hover就能看到
- **明显标识**：蓝色背景，白色文字，带图标
- **禁用状态**：如果正在加载，按钮会变灰并禁用

## ⚠️ 注意事项

1. **重试会使用相同的参数**：包括相同的系统提示词、消息历史等
2. **重试次数**：目前没有限制，可以多次点击重试
3. **状态反馈**：重试时会显示"🔄 正在重试..."状态
