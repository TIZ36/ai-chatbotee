syntax = "proto3";
package newbie;
import "msg/msg.proto";
import "enumx/enumx.proto";
import "third/github.com/go-proto-validators/validator.proto";
import "third/github.com/gogo/protobuf/gogoproto/gogo.proto";

option go_package = "verse/backend/pb/pb_newbie";
option (gogoproto.goproto_getters_all) = false;

//----------------------------------- UP MSG -------------------------------------------------------
message Up_Union {
  oneof body {
    option (validator.oneof)                           = {required: true};
    Up_PassFpsStage            passFpsStage            = 1;
    Up_SetTownEventAcceptTime  setTownEventAcceptTime  = 2; // 设置事件接受时间
    Up_TakeTownEventReward     takeTownEventReward     = 3; // 领取内城区事件奖励
    Up_TakeEventProgressReward takeEventProgressReward = 4; // 事件进度领奖
    enumx.TownEventType        setTownEventDone        = 5; // 设置事件完成
  }
}


//----------------------------------- DOWN MSG -------------------------------------------------------
message Dn_Union {
  oneof body {
    Dn_PassFpsStage            passFpsStage            = 1;
    Dn_SetTownEventAcceptTime  setTownEventAcceptTime  = 2; // 设置事件接受时间
    Dn_TakeTownEventReward     takeTownEventReward     = 3; // 领取内城区事件奖励
    Dn_TakeEventProgressReward takeEventProgressReward = 4; // 事件进度领奖
    msg.TownEvent              setTownEventDone        = 5; // 设置事件完成
  }
}

//-------------------------------------------------------------------------------------------------------
// PassFpsStage
message Up_PassFpsStage {
  enumx.FpsBattleType fpsBattleType = 1; // FPS战斗类型
  uint32              buildingID    = 2;
  uint32              gridID        = 3; // 地格ID
  uint32              fpsStage      = 4;
}


message Dn_PassFpsStage {
  uint32         buildingID = 1;
  uint32         fpsStage   = 2;
  msg.CostReward costReward = 3;
}

//-------------------------------------------------------------------------------------------------------
// SetTownEventAcceptTime
message Up_SetTownEventAcceptTime{
  enumx.TownEventType eventType  = 1; // 事件类型
  int64               acceptTime = 2 [(validator.field) = {int_gt: 0}]; // 接受时间>0
}

message Dn_SetTownEventAcceptTime {
  enumx.TownEventType eventType  = 1; // 事件类型
  int64               acceptTime = 2; // 接受时间
}

//-------------------------------------------------------------------------------------------------------
// TownEventReward
message Up_TakeTownEventReward {
  enumx.TownEventType eventType = 1; // 事件类型
  uint32              taskID    = 2; // 任务ID(如果有)
}

message Dn_TakeTownEventReward {
  msg.TownEvent eventData = 1; // 事件
  msg.Reward    reward    = 2;
}

//-------------------------------------------------------------------------------------------------------
// 事件进度领奖
message Up_TakeEventProgressReward {
  enumx.TownEventType eventType = 1; // 事件类型
  uint32              stepID    = 2; // 步骤ID
}

message Dn_TakeEventProgressReward {
  msg.TownEvent eventData = 1; // 事件
  msg.Reward    reward    = 2;
}