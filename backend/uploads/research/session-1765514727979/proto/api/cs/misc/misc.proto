syntax = "proto3";
package misc;
import "msg/msg.proto";
import "msg/map_msg.proto";
import "enumx/enumx.proto";
import "third/github.com/go-proto-validators/validator.proto";
import "third/github.com/gogo/protobuf/gogoproto/gogo.proto";

option go_package = "verse/backend/pb/pb_misc";
option (gogoproto.goproto_getters_all) = false;

//------------------------------------------------------------------------------------------
message Up_Union {
  oneof body {
    option (validator.oneof)             = {required: true};
    Up_SetClientRecord  setClientRecord  = 1; // 设置客户端记录
    Up_SupplyDraw       supplyDraw       = 2; // 抽卡
    Up_CommanderLevelUp commanderLevelUp = 3; // 军衔升级
    msg.Empty           queryPreWarning  = 4; // 拉取个人预警信息
  }
}

message Dn_Union {
  oneof body {
    Dn_SetClientRecord  setClientRecord  = 1;
    Dn_SupplyDraw       supplyDraw       = 2;
    Dn_CommanderLevelUp commanderLevelUp = 3;
    msg.PreWarning      queryPreWarning  = 4;
  }
}

message Up_SetClientRecord {
  uint32 key   = 1;
  int64  value = 2;
  bool   isBit = 3; // 是否bit记录
}

message Dn_SetClientRecord {
  uint32 key   = 1;
  int64  value = 2;
  bool   isBit = 3; // 是否bit记录
}

// 抽卡
message Up_SupplyDraw {
  uint32               supplyID         = 1; // 卡池ID
  enumx.SupplyDrawType drawType         = 2; // 抽取类型
  uint32               drawCount        = 3; // 抽取次数
  uint32               scoreRewardIndex = 4; // 积分兑换索引
}

message Dn_SupplyDraw {
  msg.SupplyCase     supplyCase    = 1; // 卡池信息
  repeated msg.Asset supplyResults = 2[(gogoproto.nullable) = false]; // 抽卡结果
  repeated int32     cardIndexList = 3; // 整卡索引列表
}

message Up_CommanderLevelUp {
}

message Dn_CommanderLevelUp {
  uint32 commanderLv = 1; // 军衔等级
}