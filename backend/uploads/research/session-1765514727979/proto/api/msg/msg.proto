syntax = "proto3";
package msg;
option go_package = "verse/backend/pb";

import "enumx/enumx.proto";
import "enumx/csv_enumx.proto";
import "msg/number.proto";
import "optx/optx.proto";
import "third/github.com/gogo/protobuf/gogoproto/gogo.proto";
import "third/github.com/go-proto-validators/validator.proto";
option (gogoproto.goproto_getters_all) = false;

message Empty {}
message Bool {

  option (gogoproto.equal) = true;
  bool val = 1;
}

message Uint32 {
  option (gogoproto.equal) = true;
  uint32 val = 1;
}

message UintKV {
  option (gogoproto.equal) = true;
  uint32 key = 1;
  uint64 val = 2;
}

message Int32KV {
  option (gogoproto.equal) = true;
  int32 key = 1;
  int32 val = 2;
}

message Uint32KV {
  option (gogoproto.equal) = true;
  uint32 key = 1;
  uint32 val = 2;
}

message Uint64KV {
  option (gogoproto.equal) = true;
  uint64 key = 1;
  uint64 val = 2;
}

message Uint32FloatKV {
  option (gogoproto.equal) = true;
  uint32 key = 1;
  float  val = 2;
}

message PowerElementDecimalKV {
  option (gogoproto.equal) = true;
  uint32  powerElementType = 1; // PowerElementType 枚举值
  Decimal decimal          = 2 [(gogoproto.nullable) = false]; // 战力值（保留小数）
}

message UintKVList {
  repeated UintKV list = 1 [(gogoproto.nullable) = false];
}

message StringIntKV {
  option (gogoproto.equal) = true;
  string key = 1;
  int64  val = 2;
}

message IntFloatKV {
  option (gogoproto.equal) = true;
  uint32 key = 1;
  float  val = 2;
}

message UintBoolKV {
  option (gogoproto.equal) = true;
  uint32 key = 1;
  bool   val = 2;
}

message UintInt64KV {
  option (gogoproto.equal) = true;
  uint32 key = 1;
  int64  val = 2;
}

message Int64Pair {
  option (gogoproto.equal) = true;
  int64 val1 = 1;
  int64 val2 = 2;
}
message Uint32Float64KV {
  option (gogoproto.equal) = true;
  uint32 key = 1;
  double val = 2;
}
message StringIntKVList {
  repeated StringIntKV list = 1 [(gogoproto.nullable) = false];
}

message StringList {
  repeated string list = 1 [(gogoproto.nullable) = false];
}

// 使用的地方 为了避免小对象的内存分配,尽量加上 [(gogoproto.nullable) = false]
message IntPos {
  option (gogoproto.equal) = true;
  int32 x = 1;
  int32 y = 2;
}

// 使用的地方 为了避免小对象的内存分配,尽量加上 [(gogoproto.nullable) = false]
message FloatPos {
  option (gogoproto.equal) = true;
  float x = 1;
  float y = 2;
}

message Float64Pos {
  option (gogoproto.equal) = true;
  double x = 1;
  double y = 2;
}

// 六边形三维坐标
message CubeCoord {
  option (gogoproto.equal) = true;
  int32 q = 1;
  int32 r = 2;
  int32 s = 3;
}

message RecoverData {
  option (gogoproto.equal) = true;
  int64 val          = 1;
  int64 lastCalcTime = 2;
}

message WallHelpInfo {
  int64           recordTs    = 1; // 记录时间（秒，隔天重置）
  repeated uint32 helpUidList = 2[(gogoproto.nullable) = false]; // 今日已帮助
}

message WallData {
  int64               val            = 1;
  int64               maxVal         = 2;
  int64               lastCalcTime   = 3;
  double              burningSpeed   = 4; // 燃烧速度（主基地才有燃烧）
  double              recoverSpeed   = 5; // 恢复速度
  //bool                isRepaired   = 6; // 是否修复过
  WallHelpInfo        wallHelpInfo   = 7; // 城墙帮助信息
  enumx.WallStateType state          = 8; // 城墙状态
  int64               lastRepairedTs = 9; // 上次修复时间（秒）
}

message AvatarPos {
  uint32   avatarID = 1;
  FloatPos pos      = 2[(gogoproto.nullable) = false];
}

message NameCard {
  string name         = 1; // 姓名
  int64  lastModifyTs = 2; // 最近一次修改时的时间戳
}

// 这个修改了 和线上是兼容的
message Avatar {
  option (gogoproto.equal)      = true;
  uint32            ID          = 1; // 配置表中的头像ID
  string            customUrl   = 2; // 平台用户头像图片的URL
  uint32            avatarFrame = 3; // 头像框
  enumx.AvatarWhich whichAvatar = 4; // 使用哪个头像，默认使用头像ID
}

message AvatarCard {
  Avatar avatar   = 1; // 玩家头像
  int64  modifyTs = 2; // 头像修改时间
}

message GenderCard {
  enumx.Gender gender       = 1; // 性别
  int64        lastModifyTs = 2; // 最近一次修改时的时间戳
}

message HonorTitle {
  uint64                 totalPower     = 1; // 总战力 通过战力计算当前称号，战力增长时需要更新historyBestTitle
  UserHonorPower         userHonorPower = 2; // 玩家荣誉称号
  repeated SpecificPower specificPower  = 3; // 细分战力值
  uint32                 rankRate       = 4; // 排名百分比，需要实时查询榜单
  uint32                 rank           = 5; // 排名，需要实时查询榜单
}

message UserHonorPower {
  uint32 historyTitle     = 1; // 历史最高到达的荣誉称号id
  uint32 bestTitle        = 2; // 最强称号id
  int64  bestTitleExpires = 3; // 最强称号过期时间
  // uint32 currentTitle = 4; // 当前荣誉称号id
}

message SpecificPower {
  enumx.RankBoardType rankType = 1;
  uint64              power    = 2;
  uint32              rankRate = 3; // 排名百分比
}

message Preference {
  option (gogoproto.equal)   = true;
  enumx.PreferenceType type  = 1; // 类别
  uint32               value = 2; // 对应数值
}

// usummary对kvRepair的适配有问题，不要再加version了
message USummary {
  option (optx.structuralVersion)           = 1;
  option (gogoproto.equal)                  = true;
  int64                    uid              = 1 [(optx.primaryKeyPriority) = 1]; // 玩家id
  string                   name             = 2; // 玩家姓名
  enumx.Gender             gender           = 3; // 性别
  Avatar                   avatar           = 4; // 玩家头像

  bool                     isOnline         = 5; // 是否在线
  int64                    lastLogoutTs     = 6; // 上次离线时间
  bool                     isDefault        = 7; // 标识这个数据是否是默认构造的
  bool                     isInactive       = 8; // 该角色是否已注销
  int64                    hourlyUpdateTs   = 9; // 玩家每小时刷新时间

  uint32                   sid              = 10; // 玩家所在服务器id
  uint32                   mapID            = 20; // 玩家所在地图实例id
  uint32                   cityID           = 11; // 玩家所在城市id city.csv
  string                   openID           = 12; // 玩家openID
  string                   token            = 13; // im 验证token, 默认使用sdk token
  uint32                   guildID          = 14; // 公会id
  uint32                   mainBaseLv       = 15; // 玩家主基地等级
  uint64                   fightPower       = 16; // 战力
  enumx.Lang               lang             = 17; // 玩家语言
  repeated Buff            battleBuffs      = 18[(gogoproto.nullable) = false]; // 战斗buff
  int64                    killedNum        = 19; // 击杀数

  string                   abGroup          = 21; // abtestGroup
  SystemSetting            systemSetting    = 22[(gogoproto.nullable) = false]; // 系统设置, 全局系统设置存储

  repeated TimeLimitedBuff timeLimitedBuffs = 23[(gogoproto.nullable) = false]; // 限时buff
  repeated TimeLimitState  timeLimitStates  = 24[(gogoproto.nullable) = false]; // 限时状态
  uint32                   bestTitle        = 25; // 最强称号id
  uint32                   historyTitle     = 26; // 历史最高到达的荣誉称号id
  uint32                   vipLevel         = 27; // vip等级
}

message RankInfo {
  uint32 rank    = 1; // 排名
  uint32 percent = 2; // 玩家排名靠前万分比, rank为0时生效
}

message RankEntry {
  int64          key    = 1;
  int64          rank   = 2; // 在当前列表的顺序
  repeated int64 points = 3;
  oneof info {
    RankUserInfo   user   = 4;
    RankGuildInfo  guild  = 5;
  }
  oneof ext{
    RankExtArena           arena           = 6;
    RankExtCityBoss        cityBoss        = 7;
    RankExtGuildBossMember guildBossMember = 8;
  }
}

message RankUserInfo {
  string               name           = 1;
  Avatar               avatar         = 2; // 玩家头像
  uint32               bestTitle      = 3; // 最强称号
  enumx.GuildMemberPos pos            = 6; // 公会成员等级
  uint32               svrID          = 7; // 服务器ID
  uint32               baseLevel      = 8; // 基地等级
  string               guildShortName = 9; // 公会简称
}

message RankGuildInfo {
  string          fullName   = 1; // 公会全称
  string          shortName  = 2; // 公会简称
  repeated uint32 picture    = 3; // 公会旗帜
  string          masterName = 4; // 盟主姓名
  uint32          svrID      = 5;
}

message RankExtArena {
  uint64 fightPower = 1; //战力
  uint32 reserveId  = 2; // 预备役ID
}

message RankExtCityBoss {
  repeated CityBossLegion legions = 1; // 阵容
}

message RankExtGuildBossMember {
  uint32 AtkCnt     = 1; // 攻击次数
  uint64 fightPower = 2; // 战力
  uint64 maxDamage  = 3; // 单次最高伤害
}

message CityBossLegion {
  uint32         pos        = 1; // 站位 （1-5）
  uint32         cardId     = 2; // 卡牌id
  uint32         cardLevel  = 3; // 兵卡等级
  uint32         cardStar   = 4; // 兵卡星级
  repeated Skill cardSkills = 5; // 兵卡技能
}

message BanInfo {
  string reason   = 1; // 封禁原因
  int64  expireTs = 2; // 结束时间
}

// 设备信息
message DeviceInfo {
  string   pkg         = 1;  // 包名
  string   channelID   = 2;  // 分发渠道id
  string   idfa        = 3;  // ios设备广告标示符
  string   androidID   = 4;  // android设备id
  string   googleAID   = 5;  // google广告平台账号id
  enumx.OS os          = 6;  // 玩家设备操作系统
  string   osVersion   = 7;  // 玩家设备系统版本号
  string   appVersion  = 8;  // 应用版本
  string   deviceModel = 9;  // 设备产品型号
  string   deviceID    = 10; // 设备ID
}

message Items {
  repeated Item items = 1[(gogoproto.nullable) = false];
}

// 通用物品(包含资源、武器装备、道具等)
message Item {
  uint64  id        = 1 [(gogoproto.nullable) = false]; // item seq id
  uint32  tid       = 2 [(gogoproto.nullable) = false]; // item template id
  uint64  num       = 3; // 数量
  uint64  expireTs  = 4; // 过期时间 0 表示永不过期
  oneof Extend {
    Card    cardData  = 21; // 卡牌(英雄)
    Equip   equipData = 22; // 英雄装备
    Citizen citizen   = 30; // 居民(W3)
  }

}

// 军官战力详情（养成线用）- old version
message CardPowerDetail {
  double base_level         = 1;  // 等级战力
  double base_star          = 2;  // 星级战力
  double skill              = 3;  // 技能战力
  double equip              = 4;  // 装备战力
  double all_science_bonus  = 10; // 所有科技对该军官的加成
  double all_building_bonus = 11; // 所有建筑对该军官的加成
  double all_citizen_bonus  = 12; // 所有居民对该军官的加成
}

// 英雄, wrapped by Item
message Card {
  uint32                    tid            = 1; // 卡牌id
  uint32                    level          = 2; // 等级
  uint32                    star           = 3; // 星级
  repeated Skill            skills         = 4; // 技能
  int64                     lastResetTs    = 5; // 上次重置时间
  uint32                    power          = 6; // 战力
  repeated CardWearingEquip equips         = 7; // 装备
  repeated Buff             buffs          = 8 [(gogoproto.nullable) = false]; // buffs

  // W3字段 暫留
  uint32                    skillPoint     = 28; // 特性点
  uint32                    appointHeroTid = 29; // 任命英雄tid
  Decimal                   newLevelPower  = 30[(gogoproto.nullable) = false]; // 等级战力
  Decimal                   newStarPower   = 31[(gogoproto.nullable) = false]; // 星级战力
  Decimal                   newSkillPower  = 32[(gogoproto.nullable) = false]; // 技能战力
  Decimal                   newEquipPower  = 33[(gogoproto.nullable) = false]; // 装备战力
  Decimal                   newPower       = 34[(gogoproto.nullable) = false]; // 战力
  map<uint32, double>       bonusPowers    = 35[(gogoproto.nullable) = false]; // 各系统对该军官的加成战力明细 - key: powerelementtype value: 加成战力
}


// 军官
message Hero {
  uint32 id             = 1; //
  uint32 level          = 2; // 等级
  uint32 appointCardTid = 3; // 任命卡牌tid
}
// 居民
message Citizen {
  uint32 tid               = 1; // 居民id
  uint32 star              = 2; // 星级
  uint32 appointBuildingID = 3; // 任命建筑tid
  uint32 power             = 4; // 战力 - old version
}
// 技能
message Skill {
  uint32 id    = 1; // 技能id
  uint32 level = 2; // 技能等级
}

// 属性
message Attr {
  uint32 id    = 1; // 属性id
  float  value = 2; // 属性值
}

//-------------------------------------- 主城建筑 ----------------------------------------------------

// 主基地保护罩
message BaseShield {
  uint32 effectTs  = 1; // 保护罩生效时间戳
  uint32 expireTs  = 2; // 保护罩结束时间戳
  bool   isAborted = 3; // 保护罩是否被打断
}

message Building {
  uint32                       buildingID        = 1; // 建筑id
  uint32                       level             = 2; // 建筑等级
  bool                         unlocked          = 3; // 是否解锁
  int64                        unlockTs          = 4; // 解锁时间戳
  uint32                       param             = 5; // 客户端用的参数
  bool                         isRewardRecved    = 6; // 是否已领取奖励
  repeated msg.Uint32KV        appointCitizen    = 7 [(gogoproto.nullable) = false]; // key 槽位 value 被委任的居民Tid
  repeated msg.Uint32Float64KV citizenBuff       = 8 [(gogoproto.nullable) = false]; // 委派居民的buff

  // 战力字段
  double                       self_power        = 100; // 建筑自身战力 - old version
  double                       all_officer_bonus = 101; // 对所有军官的加成 - old version
}

message HomeGridData {
  uint32                          gridID      = 1; // 地格ID
  bool                            eventDone   = 2; // 地格事件是否完成
  enumx.RoadClientExtraStatusType extraStatus = 3; // 客户端额外状态(客户端自己定义)
  repeated enumx.MainCityRoadType gridEvents  = 4; // 完成的地格事件列表
}

// 新手期间已经完成的关卡
message HomeStageData {
  uint32           gridID  = 1; // 地格ID
  uint32           stageID = 2; // 关卡ID
  enumx.BattleType type    = 3;    // 战斗类型
}

//-------------------------------------- 奖励消耗 ----------------------------------------------------
//message Reward {
//  repeated Item items  = 1[(gogoproto.nullable) = false]; // 增量奖励（展示）
//}
//
//message Cost {
//  repeated Item items = 1[(gogoproto.nullable) = false]; // 支付的代价 从身上扣除这些items
//}
//
//// 消耗和奖励
//message CostReward {
//  Cost   cost   = 1; // 消耗 需扣除的res
//  Reward reward = 2; // 奖励 需添加的res
//}
//
//// 消耗和奖励，包含变化的资源，以及不可堆叠道具的全量数据
//message CostRewardAll {
//  Cost   cost   = 1; // 消耗 需扣除的res
//  Reward reward = 2; // 奖励 需添加的res
//  repeated Item FullItems = 3; // 上面的cost/reward中包含的可堆叠道具的全量数据
//}


message Assets{
  repeated Asset assets = 1[(gogoproto.nullable) = false];
}

message Asset {
  option (gogoproto.equal) = true;
  enumx.AssetType type   = 1; // 类别
  enumx.AssetID   id     = 2 [(validator.field) = {int_gt: -1, is_in_enum: false}]; // 有些type可以不带ID,所以允许0, 并且这里的id会支持item和hero的id,不需要在enum中
  uint64          amount = 3; // 数量
}

message AssetKey {
  enumx.AssetType type = 1; // 类别
  enumx.AssetID   id   = 2 [(validator.field) = {int_gt: -1, is_in_enum: false}]; // 有些type可以不带ID,所以允许0, 并且这里的id会支持item和hero的id,不需要在enum中
}

message Reward {
  repeated Asset assets = 1[(gogoproto.nullable) = false]; // 常规奖品
}

message Currency {
  enumx.AssetID assetID    = 1 [(validator.field) = {is_in_enum: true}]; // 类别
  uint64        amount     = 2; // 数量
  uint64        debtAmount = 3; // 欠款数量，如果要扣负，先把amount扣到0，再扣负
}

message Cost {
  repeated Asset assets = 1[(gogoproto.nullable) = false]; // 支付的代价 从身上扣除这些assets
}

message CostReward {
  Cost   cost   = 1; // 消耗 需扣除的asset
  Reward reward = 2; // 奖励 需添加的asset
}

message AssetFloat {
  enumx.AssetType type   = 1; // 类别
  enumx.AssetID   id     = 2; // id
  double          amount = 3; // 数量
}

//-------------------------------------- 活动 ----------------------------------------------------
message ScheduleEntry {
  uint32 id      = 1; // 活动ID
  int64  openTs  = 2; // 开启时间
  int64  closeTs = 3; // 结束时间
  uint32 spanID  = 4; // 期数
}

// 服务器红点
message RedDot {
  RedDotKey key = 1; // 组合key
  uint32    cnt = 2; // 计数
}

// Flag 主键
message RedDotKey {
  option (gogoproto.equal) = true;
  enumx.SvrRedDotType type = 1; // 红点类别
  int64               id   = 2; // 根据类别不同, 有各自的id定义 (不区分时id是0)
}

//-----------------------------------------------------------------------
//Friend
message FriendEntry {
  int64 uid = 1; // 玩家id
}

//------------------------------------------------------------------------------------------
message CD {
  uint32 id            = 1; // 配置id
  uint32 usedTimes     = 2; // 使用次数
  int64  lastRefreshTs = 3; // 上次刷新的时间
}

message Counter {
  uint32 id     = 1; // Counter.csv
  int64  amount = 2; // 数量
}

message Best {
  uint32 id     = 1; // Best.csv
  int64  amount = 2; // 数量
}

message UnitKey {
  option (gogoproto.equal) = true;
  oneof body {
    UnitKeyPlayer player       = 1; // 来自玩家
    uint32        staticUnitID = 2; // 来自Npc
  }
}

message UnitKeyPlayer {
  option (gogoproto.equal) = true;
  int64 uid = 1;
}

// 影响进场时数据
message UnitDyn {
  oneof body {
    UnitDynPct pct    = 1; // 英雄血量/蓝量万分比
    int64      hpLeft = 2; // 剩余生命 graid模块使用
  }
  uint64 hpMax = 3; // 总血量如果是0则客户端需要重新计算跟炳炕确认
}

message UnitDynPct {
  uint32 hpPct = 1; // 血量万分比
  uint32 mpPct = 2; // 蓝量万分比
}

message BtRecordEntry {
  string btID     = 1; // 战斗记录ID
  int64  createTs = 2; // 创建时间
  uint64 gs       = 3; // team战力
}

//-------------------------------------- 阵容----------------------------------------------------
message TraitInfo {
  uint32 id = 1; // 特性id
  float  a  = 2; // 特性参数a
  float  b  = 3; // 特性参数b
}

message LegionInfo {
  uint32 pos       = 1; // 站位 （1-5）
  uint32 cardId    = 2; // 卡牌id
  uint32 armyLevel = 3; // 兵卡等级
  uint32 armyStar  = 4; // 兵卡星级
}

message Formation {
  uint32              id                  = 1;      //
  repeated LegionInfo legions             = 2; // 阵容
  uint32              selectCommandCardId = 3; // 选中的指挥官卡牌id
  bool                isCommandActive     = 4; // 指挥技能是否激活

  // 战力字段
  uint64              power               = 100; // 编队总战力
  uint64              heroPower           = 101; // 军官战力 - old version 90 日版本废弃
  uint64              soldierPower        = 102; // 士兵战力 - old version 90 日版本废弃

  // new version
  uint64              dronePower          = 103; // 无人机 -old version 90 日版本废弃

}

message FormationGroup {
  enumx.FormationType type       = 1; // 阵容类型
  repeated Formation  formations = 2; // 阵容
}

// 进行中的战斗，等待结束和校验
message PendingBattle {
  enumx.BattleType battleType     = 1; // 战斗类型
  uint32           gridId         = 2; // 下城区地格ID
  uint32           stageId        = 3; // 关卡id
  uint32           seed           = 4; // 随机种子
  uint32           startTs        = 5; // 开始时间

  Formation        formation      = 6; // 阵容
  Formation        enemyFormation = 7; // 敌方阵容
}

//-------------------------------------------------------------
// WorldSvr Entry : save in MongoDB and RedisCache
message WorldEntry {
  option (optx.structuralVersion)   = 0;
  option (gogoproto.equal)          = true;
  uint32               worldID      = 1[(optx.primaryKeyPriority) = 1]; // worldSvr ID
  uint64               openTime     = 2; // 开服时间
  uint32               nodeID       = 3; // 节点ID [节点调度路由]

  uint64               loadStartMS  = 4; // 开始加载时间 ms
  enumx.EntryLoadState loadState    = 5; // 加载状态

  uint32               AmendVersion = 10; // 数据升级版本号
}

//-------------------------------------------------------------
// 地图服的通用entry （包括城市服、副本服） : save in MongoDB and RedisCache
message MapEntry {
  option (optx.structuralVersion)   = 0;
  option (gogoproto.equal)          = true;
  uint32               worldID      = 1; // worldSvr ID
  uint32               mapID        = 2[(optx.primaryKeyPriority) = 1]; // map instance ID
  enumx.MapType        mapType      = 3; // map 类型(城市、副本等)
  uint32               mapConfID    = 4; // map 配置ID
  uint32               cityID       = 9; // 城市ID [deprecated]

  uint64               openTime     = 5; // 开服时间
  uint32               nodeID       = 6; // 节点ID [节点调度路由]

  uint64               loadStartMS  = 7; // 开始加载时间 ms
  enumx.EntryLoadState loadState    = 8; // 加载状态

  uint32               AmendVersion = 15; // 数据升级版本号
}

//-------------------------------------------------------------
// GuildEntry : save in Redis StreamHSet
message GuildEntry {
  option (optx.structuralVersion) = 0;
  option (gogoproto.equal)        = true;
  uint32 guildID = 1[(optx.primaryKeyPriority) = 1]; // 公会ID
  uint32 sid     = 2; // 公会所属服务器ID
}

// ---------------------- Chat ---------------------
message IMUserInfo {
  uint32            uid         = 1;
  uint32            guildID     = 2;
  uint32            mapID       = 8;
  uint32            cityID      = 3;
  uint32            iconID      = 4;
  uint32            iconFrameID = 5;
  uint32            cityLevel   = 6; //
  uint64            fightPower  = 7; // 战斗力
  string            name        = 10;
  // string cityName    = 11; 客户端根据cityID自己查
  string            iconUrl     = 12;
  string            guildSName  = 13; // GuildShortName
  enumx.AvatarWhich whichAvatar = 14; // 使用哪种头像
  SystemSetting     sysSetting  = 15[(gogoproto.nullable) = false];  // 系统设置, 全局系统设置存储
  uint32            honorTitle  = 16; // 荣誉称号
  uint32            bestTitle   = 17; // 最强称号id
  uint32            SvrID       = 18; // 服务器ID
  uint32            vipLevel    = 19; // vip等级
}
// ---------------------- Chat End -------------------

//-------------------------------------------------------------
//-------------------------------------- 卡池----------------------------------------------------

message SupplyCase {
  uint32 id              = 1; // 卡池id
  uint32 dailyDrawCount  = 2; // 每日抽卡次数
  int64  dailyTs         = 3; // 时间戳
  int64  freeDrawEndTs   = 4; // 下次免费时间戳
  uint32 guaranteedCount = 5; // 保底计次
  uint32 drawScore       = 6; // 抽卡积分
}

message AirdropInfo {
  int64  lastAirdropTs = 1; // 上次空投时间
  uint32 airdropCount  = 2; // 累计空投次数
}

message BuildingProduce {
  uint32         buildingID    = 1; // 建筑ID
  int64          lastCalcTs    = 2; // 上次生产计算时间（秒）
  repeated Asset accResList    = 3[(gogoproto.nullable) = false]; // 累计生产资源列表
  bool           full          = 4; // 是否满了
  uint32         buildingLevel = 5; // 建筑等级
  int64          intervalTime  = 6; // 生产间隔时间（秒）
  uint32         produceCount  = 7; // 生产次数
  uint32         acceptCount   = 8; // 领取次数
  uint32         accBatchCount = 9; // 当前累计批次次数
  repeated Asset curSpeed      = 10[(gogoproto.nullable) = false];// 当前产出速度
}

// 科技战力详情（养成线用）
message SciencePowerDetail {
  double  self_power         = 1; // 科技自身战力
  double  all_officer_bonus  = 2; // 对所有军官的加成
  double  all_soldier_bonus  = 3; // 对所有士兵的加成

  // new version
  Decimal newSelfPower       = 4; // 科技自身战力
  Decimal newAllOfficerBonus = 5; // 对所有军官的加成
  Decimal newAllSoldierBonus = 6; // 对所有士兵的加成
}

message Science {
  uint32             id                                = 1; // 科技ID
  uint32             level                             = 2; // 科技等级

  // 战力字段 - old version
  uint64             power                             = 100; // 科技总战力
  uint64             fixedPower                        = 101; // 科技固定战力
  uint64             fixedSoldierThreeDimensionPower   = 102; // 科技-对士兵提供的三维固定值加成战力
  uint64             percentSoldierThreeDimensionPower = 103; // 科技-对士兵提供的三维百分比加成战力
  SciencePowerDetail power_detail                      = 110; // 战力详情缓存
}

message ScienceQueue {
  uint32                 id       = 1; // 科技ID
  uint32                 level    = 2; // 科技等级
  int64                  endTs    = 3; // 科技结束时间戳
  enumx.ScienceQueueType queueID  = 4; // 科技队列ID
  int64                  duration = 5; // 科技持续时间（秒）
  repeated Asset         costRes  = 6[(gogoproto.nullable) = false]; // 科技消耗资源列表
}

message ScienceGroup {
  option (gogoproto.equal)                  = true;
  uint32 groupId     = 1;
  uint32 finishCount = 2; //累计完成的科技数量
}

message FightPower {
  enumx.FightPowerType type  = 1; // 战力类型
  uint64               power = 2; // 战斗力
}

message ShopSlot {
  uint32 slotId   = 1; // 商品槽位ID
  uint32 goodsId  = 2; // 商品ID
  uint32 buyTimes = 3; // 购买次数
}

message Shop {
  uint32            id        = 1; // 商店ID
  repeated ShopSlot goodsList = 3[(gogoproto.nullable) = false]; // 商品列表
}

message ItemList {
  enumx.AssetType assetType = 1; // 资产类型
  repeated Item   items     = 2; // 物品列表
}

message TimeLimitState {
  option (gogoproto.equal)            = true;
  enumx.TimeLimitedStateType state    = 1; // 状态
  uint32                     expireTs = 2; // 过期时间戳
  uint32                     startTs  = 3; // 开始时间戳
}

message Buff {
  option (gogoproto.equal) = true;
  uint32 id    = 1; // buff id
  double value = 2; // buff值
}

// 限时buff
message TimeLimitedBuff {
  option (gogoproto.equal)     = true;
  uint32              id       = 1; // buff id
  double              value    = 2; // buff值
  uint32              expireTs = 3; // 结束时间戳
  uint32              startTs  = 4; // 开始时间戳
  enumx.BuffGroupType type     = 5; // 限时buff来源, 方便统一更新限时时间
}

message BuffList {
  option (gogoproto.equal)                  = true;
  enumx.BuffGroupType group = 1; // buff组
  repeated Buff       buffs = 2[(gogoproto.nullable) = false]; // buff列表
}

message GuildBuff {
  uint32        guildID      = 1; // 公会ID
  repeated Buff ScienceBuffs = 2[(gogoproto.nullable) = false]; // 科技buff列表
  repeated Buff VillageBuffs = 3[(gogoproto.nullable) = false]; // 村庄buff列表

  // guild side used
  int64         LastUpdateMS = 10; // 最后更新时间
  bool          IsDirty      = 11; // 是否脏数据
}

// ----------------------------------------- Newbie ----------------------------------------------------
message TownEvent {
  enumx.TownEventType eventType  = 1; // 事件类型
  int64               acceptTs   = 2 [(validator.field) = {int_gt: -1}]; // 接受时间戳
  bool                eventDone  = 3; // 事件是否完成
  repeated Task       tasks      = 4; // 事件下的任务列表
  repeated uint32     svrStepIDs = 5; // 服务器进度
  repeated uint32     cliStepIDs = 6; // 客户端进度
}

message TaskSystem{
  enumx.TaskSystemType system = 1; // 任务组ID
  repeated Task        tasks  = 2; // 任务列表
}

message Task {
  uint32              id       = 1; // 任务ID
  uint32              progress = 2; // 任务进度
  enumx.TaskStateType state    = 3; // 任务状态
}

message HomeMistData {
  uint32               mistID     = 1; // 迷雾ID
  enumx.HomeMistStatus mistStatus = 2; // 迷雾状态
}

message HomeArea {
  uint32              id    = 1;
  enumx.HomeAreaState state = 2;
}

message LegionShowSimple {
  uint32 pos    = 1; // 位置 1-5
  uint32 cardId = 2; // 兵卡id
}

// 玩家展示兵卡信息
message LegionShow {
  uint32 pos         = 1; // 位置 1-5
  uint32 cardId      = 2; // 兵卡id
  uint32 cardLevel   = 3; // 兵卡等级
  uint32 cardStar    = 4; // 兵卡星级
  uint32 heroId      = 5; // 军官id
  uint32 heroLevel   = 6; // 军官等级
  bool   isCardAwake = 7; // 兵卡是否觉醒
}

message PlayerShowInfo {
  int64                   uid            = 1; // 玩家UID
  repeated msg.LegionShow formationShow  = 2; // 展示阵容
  string                  name           = 3; // 昵称
  string                  iconUrl        = 4; // 头像URL
  uint32                  iconId         = 5; // 头像ID
  uint32                  iconFrameId    = 6; // 头像框ID
  map<uint32, uint64>     statInfo       = 7; // 统计信息  (key为ShowStatType类型)
  repeated FightPower     fightPowerList = 8; // 战力信息 - 已废弃
  uint32                  svrId          = 9; // 服务器ID
  enumx.Gender            gender         = 10; // 性别
  enumx.AvatarWhich       whichAvatar    = 11; // 使用哪个头像
  SystemSetting           sysSetting     = 12[(gogoproto.nullable) = false]; // 系统设置, 全局系统设置存储
  Uint32                  honorTitle     = 13; // 荣誉称号, 空值表示没有荣誉称号
  Uint32                  bestTitle      = 14; // 最强称号id, 空值表示没有最强称号
  string                  guildFullName  = 15; // 联盟全称
  string                  guildShortName = 16; // 联盟简称
  int64                   likeCnt        = 17; // 被点赞总数
  bool                    isGuildMaster  = 18; // 是否是联盟盟主
  repeated FightPower     fightPowers    = 19[(gogoproto.nullable) = false]; // 新战力
  int64                   gid            = 20; // 联盟ID
}

message ShortPlayerShowInfo {
  uint32       uid            = 1 [(optx.primaryKeyPriority) = 1]; // 玩家id
  string       name           = 2; // 玩家姓名
  enumx.Gender gender         = 3; // 性别
  Avatar       avatar         = 4; // 玩家头像
  uint32       mapID          = 5; // 玩家所在地图实例id
  uint32       cityID         = 6; // 玩家所在城市id city.csv
  uint32       guildID        = 7; // 公会id
  uint32       mainBaseLv     = 8; // 玩家主基地等级
  uint64       fightPower     = 9; // 战力
  string       guildShortName = 10; // 公会简称
}


message SystemSetting {
  option (gogoproto.equal) = true;
  //Bool notAllowJoinGroup   = 1;
  bool notAllowJoinGroup = 2; // 禁止被拉入群聊
}

message GiftPackage {
  uint32 index  = 1; // 礼包索引
  uint32 id     = 2; // 当前礼包ID
  uint32 buyCnt = 3; // 当前礼包购买了多少次
  int64  ts     = 4; // 礼包购买时间
}

message GiftPackageGroup {
  uint32               groupID    = 1; // 礼包组ID
  uint64               scheduleID = 2; // 礼包组绑定的活动ID
  repeated GiftPackage packages   = 3; // 礼包列表
  int64                createTime = 4; // 创建时间
  string               traceID    = 5; // 鸢尾花追溯ID
}

message OpenIDInfo {
  int64  appID    = 1; // app id
  string appUID   = 2; // app uid
  string platform = 3; // 平台
}

message ActivityKey {
  uint64 scheduleId = 1; // 活动schedule ID
  uint32 subKey     = 2; // 子索引（使用主活动的开始时间作为子索引）
}

message ActivityData {
  uint64       scheduleId = 1; // 活动schedule ID
  uint32       subKey     = 2; // 子索引（使用主活动的开始时间作为子索引）
  ActivityUnit activity   = 3; // 活动
}

message ActivityUnit {
  enumx.ActivityModule       module                 = 1; // 活动模块
  int64                      startTs                = 2; // 活动开始时间戳
  int64                      endTs                  = 3; // 活动结束时间戳
  repeated Task              tasks                  = 4; // 活动任务
  uint32                     bundleGroupID          = 5; // 礼包bundle group ID
  bool                       isTaskUpdate           = 6; // 活动任务是否初始更新过
  repeated ActivityTaskGroup taskGroups             = 7; // 任务组列表
  repeated ActivityUnit      subActivities          = 8; // 子活动
  repeated uint32            extraBundleGroupIDs    = 9; // 礼包bundle group ID
  msg.ActParticipationRecord actParticipationRecord = 10; // 活动活跃度+奖励领取记录
  bool                       isLock                 = 11; // 是否锁住（需要付费/其他方式解锁）
  msg.ActGroupInfo           groupInfo              = 12; // 分组数据
}

message ActivityScheduleTimes {
  uint32 scheduleCfgId = 1; // 活动schedule配置ID
  uint32 times         = 2; // 活动参与次数
}

message SubmitResult {
  msg.Reward reward = 1;
  msg.Task   task   = 2;
}
message SubmitPointResult {
  uint64                     scheduleId = 1;
  msg.ActParticipationRecord record     = 2;
}
message BundleTrigger {
  uint32          id       = 1;
  repeated uint32 usedKeys = 2; // 已经使用过的key
}



message ActivityTaskGroup {
  uint32                       id    = 1; // 任务组ID
  enumx.ActivityTaskGroupState state = 2; // 任务组状态
}

message SubmitActivityTaskGroupReward {
  msg.Reward            reward    = 1; // 奖励
  msg.ActivityTaskGroup taskGroup = 2; // 任务组
}



//Guild
message GuildApplying {
  int64  uid            = 1; // 申请者的uid
  int64  applyTs        = 2; // 申请时间
  int64  power          = 3; // 战力
  uint32 headquartersLv = 4; // 总指挥部等级
  string name           = 5; // 姓名
  Avatar avatar         = 6; // 头像信息
  bool   isFirstJoin    = 7; // 是否首次加入
}

message GuildMember {
  int64                     uid               = 1; // 成员uid
  enumx.GuildMemberPos      pos               = 2; // 官职
  int64                     joinTs            = 3; // 加入时间
  enumx.GuildSeniorOfficial officialType      = 4; // 高级官员类型
  uint32                    dailyDonateScore  = 5; // 个人捐献积分（每日重置）
  uint32                    weeklyDonateScore = 6; // 个人捐献积分（每周重置）
  uint32                    firstChatMsgID    = 7; // 玩家入盟的第一条聊天id
  uint64                    killCnt           = 8; // 击杀预备役数量
}

// 公会概况
message GSummary {
  int64               gid                = 1; // 联盟id
  uint32              svrID              = 2; // 服id
  string              fullName           = 3; // 联盟全称
  string              shortName          = 4; // 联盟简称
  repeated uint32     picture            = 5; // 联盟旗帜
  enumx.Lang          lang               = 6; // 联盟语言
  uint32              memberCnt          = 7; // 联盟人数
  string              announcement       = 8; // 联盟宣言
  uint32              masterUID          = 9; // 盟主UID
  string              masterName         = 10; // 盟主名字
  enumx.GuildJoinType join               = 11; // 公会加入方式
  uint64              joinPowerLimit     = 12; // 加入公会的战力限制
  uint32              headquarterLvLimit = 13; // 公会总部等级限制
  uint64              power              = 14; // 公会总战力
  uint32              giftLevel          = 15; // 联盟礼物等级
  int64               createTime         = 16; // 联盟创建时间
  msg.IntPos          rendezvousPoint    = 17[(gogoproto.nullable) = false]; // 联盟集结点
  uint32              maxMemberCnt       = 18; // 联盟最大人数
}

message GuildTechInfo {
  uint32 id            = 1; // 科技ID
  uint32 lv            = 2; // 科技等级
  int64  researchEndTs = 3; // 科技研究结束时间戳
  uint32 exp           = 4; // 科技经验值
}

message GuildTechGroup{
  enumx.GuildTechType    typ   = 1; // 科技类型
  repeated GuildTechInfo techs = 2; // 科技列表
}

message GuildTechData {
  repeated GuildTechGroup groups            = 1;
  GuildRecommendTech      recommend         = 2; // 推荐
  uint32                  researchingTechID = 3; // 正在研究的科技ID
  bool                    nonAutoResearch   = 4; // 不启用自动研究
}

message GuildRecommendTech {
  uint32 id      = 1;
  bool   isSkill = 2; // 是否是技能，true是技能，false是科技
}

message GuildSkill {
  enumx.GuildTechType typ        = 1; // 技能类型
  uint32              id         = 2; // 技能ID
  uint32              lv         = 3; // 技能等级
  uint32              exp        = 4; // 技能充能点数
  int64               availEndTs = 5; // 技能生效的结束时间戳
  int64               cdEndTs    = 6; // 技能冷却结束时间戳
}

message UGuildTech {
  uint32 dailyGoldDonateTimes = 1; // 每日金币捐献次数，跨天重置为0；科技捐献和技能充能共用次数。
  uint32 normDonateLeftTimes  = 2; // 当前普通捐献的剩余次数，每20分钟加一次；科技捐献和技能充能共用次数。
  int64  normDonateLastCalcTs = 3; // 普通捐献上次计算时间戳
}

message GuildGiftInfo {
  uint64     uniqueID        = 1; // 礼物唯一id
  uint32     cfgID           = 2; // 礼物配置表id
  uint32     lv              = 3; // 礼物等级
  int64      createTs        = 4; // 创建时间
  int64      expireTs        = 5; // 过期时间
  bool       isRecvd         = 6; // 是否领取
  uint32     triggerID       = 7; // 玩家购买的礼包ID，或者野怪id
  int64      triggerUID      = 8; // 触发礼物的玩家uid
  string     triggerUserName = 9; // 触发当前礼物的玩家名字
  msg.Reward recvdReward     = 11; // 已经领取的奖励
}

message GuildGiftGroup{
  enumx.GuildGiftType    typ   = 1; // 礼物类型
  repeated GuildGiftInfo gifts = 2; // 礼物列表
}

message GuildGiftKey {
  enumx.GuildGiftType typ      = 1; //礼物类型
  uint64              uniqueID = 2;
}

message GuildMilestone {
  int64                       endTs = 1; // 因为里程碑是创建联盟就创建了，所以开始时间就是联盟的创建时间，这里只需要记录里程碑结束时间
  repeated GuildMilestoneTask tasks = 2; // 联盟里程碑任务列表
}

message GuildMilestoneTask {
  uint32                           taskID         = 1; // 任务ID
  msg.Task                         task           = 2; // 任务
  int64                            startTs        = 3; // 任务开始时间
  int64                            endTs          = 4; // 任务结束时间
  int64                            finishTs       = 5; // 任务完成时间
  repeated msg.GuildMemberSnapshot memberSnapshot = 6; // 任务完成时的成员快照
}
message GuildCityClash {
  int64                       endTs = 1; // 因为城市竞赛是创建联盟就创建了，开始时间就是开服的时间，这里只需要记录城市竞赛结束时间
  repeated GuildCityClashTask tasks = 2; // 城市竞赛任务列表
}
message GuildCityClashTask {
  uint32   taskID  = 1; // 任务ID
  msg.Task task    = 2; // 任务
  int64    startTs = 3; // 任务开始时间
  int64    endTs   = 4; // 任务结束时间
}

message GuildMemberSnapshot {
  int64                uid = 1; // 玩家uid
  enumx.GuildMemberPos pos = 2; // 官职
}

message UGuildGift {
  bool                       isPayGiftAnon      = 1; // 购买礼包礼物是否匿名
  repeated GuildGiftKey      deleteMaxUniqueIDs = 2; // 客户端上次删除礼物的最大uniqueID，下次下发全量给客户端的时候，小于这个id的已领取的都不会下发，只会下发小于这个id的未领取的
  repeated msg.GuildGiftInfo recvd              = 3; // 已领取的礼物uniqueID列表
}

// 联盟BOSS
message GuildBossBattle {
  option (optx.structuralVersion)               = 0;
  int64                        gid              = 1[(optx.primaryKeyPriority) = 1]; // 联盟id
  int64                        appointStartTS   = 2; // 准备阶段结束时间
  int64                        battleStartTS    = 3; // 战斗开始时间（官员在预约时间之后手动开启）
  int64                        battleEndTS      = 4; // 战斗结束时间
  int64                        scheduleStartTS  = 5; // 大周期开始时间
  int64                        scheduleEndTS    = 6; // 大周期结束时间
  uint32                       scheduleID       = 7;

  uint32                       mapID            = 10; // 联盟BOSS所在地图
  uint32                       mapCfgID         = 16; // 地图cfgID
  uint64                       objID            = 11; // 联盟BOSSObjID
  msg.IntPos                   objPos           = 12; // 联盟BOSS坐标
  uint32                       donateLv         = 13; // 联盟BOSS捐献等级
  uint32                       lvDonateCnt      = 14; // 当前等级捐献次数
  uint32                       bossLv           = 15; // 联盟BOSS等级

  uint32                       maxBossLvUnlock  = 17; // BOSS可解锁的最高等级（从1开始）
  int64                        lastAppointTS    = 18; // 上一次的预约时间
  uint32                       lastBossLv       = 19; // 上一次的BOSS等级
  // 开战后数据
  uint64                       totalDamage      = 20; // 模拟战总伤害
  repeated int64               offlineUids      = 21; // deprecated 离线参与的玩家uid
  repeated uint32              offlineIndex     = 22; // 派遣索引
  repeated int64               nonOfflineUids   = 24; // 拒绝离线参与的玩家uid

  //  bool                         rewardSent      = 23;

  bool                         memberRewardSent = 26; // 成员奖励已发放
  bool                         guildRewardSent  = 27; // 公会奖励已发放
  bool                         guildBossRemoved = 28; // 公会BOSS已被移除
  repeated msg.GuildBossMember members          = 30; // 参与成员
}

// 联盟BOSS参与成员
message GuildBossMember {
  int64  uid         = 1; // 玩家uid
  int64  maxDamage   = 2; // 单次最高伤害
  int64  totalDamage = 3; // 总伤害
  uint32 atkCnt      = 4; // 攻击次数
}

message ReserveQueue {
  int64  startTs     = 1; // 开始时间戳
  uint32 targetId    = 2;
  int64  endTs       = 3;
  uint32 targetCount = 4; // 目标数量
  uint32 curId       = 5; // 当前预留的ID, 0表示是招募
  int64  initEndTs   = 6; // 初始结束时间戳
  int64  speedupSec  = 7; // 累计加速时长（秒）
}

message ReserveUnit {
  uint32 id          = 1;
  uint32 num         = 2;
  uint32 overflowNum = 3; // 溢出数量

  // 战力字段
  uint64 power       = 100; // 预备役总战力 - 老版本等待删除
  uint64 fixedPower  = 101; // 预备役固定战力 - 老版本等待删除
}

message CardReserve {
  uint32            cardID          = 1;
  repeated Uint32KV reserves        = 2[(gogoproto.nullable) = false]; // 预备役（key:预备役tid value:预备役数量）按照等级从高到底排序
  repeated Uint32KV woundedReserves = 3[(gogoproto.nullable) = false]; // 受伤的预备役（key:预备役tid value:预备役数量）
}

message ArmyReserveInfo {
  repeated Uint32KV reserves        = 1[(gogoproto.nullable) = false]; // 预备役（key:预备役tid value:预备役数量）
  repeated Uint32KV woundedReserves = 2[(gogoproto.nullable) = false]; // 受伤的预备役（key:预备役tid value:预备役数量）
  repeated Uint32KV attrs           = 3[(gogoproto.nullable) = false]; // 预备役属性加成（key:属性id value:属性值）
}

message DailyTaskData{
  int64           lastUpdateTime = 1;
  int64           activityPoint  = 2; //活跃度
  repeated uint32 getRewardIds   = 3; // 已领的rewardId
}

message ActivitySubmitTaskData{
  msg.ActivityKey      actKey  = 1[(gogoproto.nullable) = false]; // 活动唯一id
  enumx.ActivityModule module  = 2; // 模块
  repeated uint32      taskIDs = 3; // 任务id
}
message ActivitySubmitPointAndTaskData{
  msg.ActivityKey      actKey    = 1[(gogoproto.nullable) = false]; // 活动唯一id
  enumx.ActivityModule module    = 2; // 模块
  repeated uint32      taskIDs   = 3; // 任务id
  repeated uint32      rewardIDs = 4; // 奖励id
}
message VipTimeData{
  uint32 vipLoginDays         = 1; // 记录伪连续登录过的天数（Vip用，登录每天加一天，非连续登录要减上次update时间到当天diff天数-1）
  int64  LastUpdateTs         = 2; // 上次计算连续登录的时间
  int64  LastGetLevelRewardTs = 3; // 上次领每日等级奖励时间
  int64  LastGetFreeRewardTs  = 4; // 上次领每日免费奖励时间
}

message UGuildHelpEntry {
  enumx.GuildHelpType helpType = 1; // 帮助类型，建筑、科技
  uint32              id       = 2; // 帮助ID，建筑ID、科技ID
}

message UGuildHelp {
  repeated msg.UGuildHelpEntry reqHelpList    = 1[(gogoproto.nullable) = false]; // 请求帮助信息
  uint32                       dailyGuildCoin = 2; // 每日通过帮助获得的公会币数量，跨天清零
}

message GuildHelpInfo {
  uint64              uniqueID        = 1; // 唯一id
  int64               reqUid          = 2; // 请求帮助者的uid
  repeated int64      helpedUIDs      = 3; // 已经帮助的玩家UID列表
  enumx.GuildHelpType helpType        = 4; // 帮助类型，建筑、科技
  Avatar              avatar          = 5; // 玩家头像
  string              name            = 6; // 玩家名称
  uint32              id              = 7; // 帮助ID，建筑ID、科技ID
  uint32              lv              = 8; // 建筑等级、科技等级
  uint32              maxHelpCnt      = 9; // 最大可以帮助次数
  uint32              helpCnt         = 10; // 已帮助次数
  int64               reduceTime      = 11; // 被帮助累计减少时间
  int64               maxDuration     = 12; // 最大研究时长
  int64               endTs           = 13; // 研究结束时间戳
  int64               extraReduceTime = 14; // 请求者额外减少帮助时间
}

message UGuildMilestone {
  repeated uint32 recvdTaskIDs = 1; // 已领取的milestone任务id
}
message UGuildCityClash {
  repeated uint32 recvdTaskIDs = 1; // 已领取的CityClash任务id
}

message GuildActivity {
  int64           lastUpdateTs   = 1; // 上次更新时间戳
  uint32          point          = 2; // 公会活跃度
  repeated uint32 recvdRewardIDs = 3; // 已领取的奖励id
}

message ActParticipationRecord{
  uint32          score            = 1;
  repeated uint32 getRewardIds     = 2;
  uint32          cycleRewardTimes = 3;
}

message PrivilegeCardItem{
  enumx.PrivilegeCard privilegeID       = 1;
  int64               endTs             = 2; //月卡结束时间戳，买的时候以当天0点为开始时间加31天
  int64               nextGetRewardTime = 3;
  uint32              debtDay           = 4; //因退款产生的欠款天数
  uint32              getRewardTimes    = 5; //领取奖励次数
  bool                needBuyBack       = 6; //是否需要回购
}

message AssemblyKey {
  uint32 uid         = 1;
  uint32 armyID      = 3;
  uint64 targetObjID = 2; // 目标objID
}

message GarrisonParam {
  int64 startTs = 2; // 开始时间
}

message CollectParam {
  double collectSpeed = 1; // 开始时间
  uint32 armyCapacity = 2; // 部队负重
}
message AttackParam {
  bool                 isMonster   = 1; // 是否是野怪
  enumx.MapMonsterType monsterType = 2; // 野怪类型
}

message SvrInstructionData {
  enumx.ArmyCmdType type        = 1; // 指令类型
  uint64            targetObjID = 2; // 目标对象ID
  msg.IntPos        targetPos   = 3[(gogoproto.nullable) = false]; // 目标位置
  oneof Param {
    GarrisonParam     garrison    = 12; // 驻防参数
    CollectParam      collect     = 13; // 采集参数
    AttackParam       attack      = 14; // 攻击额外参数
    msg.AssemblyKey   assembly    = 15; // 集结参数
  }
}

// 出征队伍
message ArmyInfo {
  uint32             armyID          = 1; // 队伍ID
  uint64             armyObjID       = 2; // 军队对象ID
  uint64             tarObjID        = 3; // 目标ObjID
  SMarchLineup       lineup          = 4; // 编队阵容
  enumx.ArmyStatus   status          = 5; // 军队状态
  enumx.ArmySubType  subType         = 6; // 军队子类型
  AssemblyKey        assemblyKey     = 7; // 集结key
  uint64             mask            = 8; // 部队掩码（对应ArmyMask定义）
  msg.IntPos         stopPos         = 9[(gogoproto.nullable) = false]; //停留位置
  SvrInstructionData instructionData = 10; // 指令数据
  oneof extend{
    MoveInfo           moveInfo        = 21; //移动信息
    UserCollectData    userCollectData = 22; //采集信息
  }
}

// message ArmyInfo {
//   uint32               armyID       = 1; // 军队ID
//   uint64               armyObjID    = 2; // 军队对象ID
//   uint64               tarObjID     = 3; // 目标ObjID
//   uint64               strengthCost = 4; // deprecated 本次出征消耗的体力（已废弃）
//   //repeated Uint32KV dispatchReserves = 5[(gogoproto.nullable) = false]; // 出征的预备役
//   AssemblyKey          assemblyKey  = 8; // 集结key
//   // repeated CardReserve cardReserves = 9; // 出征的兵卡预备役
//   msg.IntPos           stopPos      = 10[(gogoproto.nullable) = false]; //停留位置
//   uint64               mask         = 11; // 部队掩码（对应ArmyMask定义）
//   SvrInstructionData   instructionData = 12; // 指令数据
//   oneof extend{
//     MoveInfo        moveInfo        = 21; //移动信息
//     UserCollectData userCollectData = 22; //采集信息
//   }
// }

// 自己驻防军队信息
message SelfFormationGarrison {
  uint32               armyID   = 1; // 军队ID
  repeated CardReserve reserves = 2; // 预备役（key:预备役tid value:预备役数量）按照等级从高到底排序
}

message SMarchLineup { // 行军编队阵容
  repeated uint32 cardTids        = 1; // 兵卡
  repeated UintKV soldiers        = 2; // 部队 id-num
  repeated UintKV injuredSoldiers = 3[(gogoproto.nullable) = false]; // 轻伤部队 id-num
}

message SMarchPreset { // 行军编队预设
  uint32       id     = 1; // 预设id
  string       name   = 2; // 预设名称
  SMarchLineup lineup = 3; // 阵容
}

message ReportPower {
  enumx.ReportPowerType powerType = 1;
  uint64                power     = 2; // 战斗力
}

message BuffLabel {
  option (gogoproto.equal)                  = true;
  enumx.BuffLabelType label = 1; // buff标签类型
  repeated Buff       buffs = 2[(gogoproto.nullable) = false]; // 该标签下的buff列表 （buff.Id对应ReportAttributeDisplay表id）
}
message CitizenAppointInfo{
  uint32 citizenTid  = 1;
  uint32 buildingId  = 2;
  uint32 buildingPos = 3; // 建筑几号槽
}

message BuildingSlotData{
  uint32 buildingID   = 1;
  uint32 buildingSlot = 2;
  bool   slotUnlock   = 3;
}

message RefundData{
  uint32 mailID        = 1;
  uint32 bundleID      = 2;
  uint32 bundleGroupID = 3;
  uint32 actSubKey     = 4;
  bool   isBuyBack     = 5;
}
message CitizenOnlineData{
  int64           loginTime     = 1;
  int64           onlineTime    = 2;
  repeated uint32 getCitizenIDs = 3;
}

message SpoilItem {
  int64              id           = 1; //
  int64              createTS     = 2; // 创建时间
  int64              expireTS     = 3; // 过期时间
  enumx.SpoilTag     tag          = 4; // 标签类型
  uint32             strengthCost = 5; // 消耗的体力
  msg.Reward         reward       = 6; // 待领取的奖励
  uint32             monsterCfgID = 7;
  enumx.SpoilSubType subType      = 8; // 子类型
}

message Emoji {
  uint32 id         = 1; // 表情id
  int64  expireTime = 2; // 到期时间戳, 永久表情时为0
  uint32 slotID     = 3; // 表情槽位
}

message EmojiMessage {
  Emoji emoji      = 1;
  int64 createTime = 2; // 发送时间
}

message Like {
  int64                sourceUID  = 1; // 点赞者uid
  enumx.LikeSourceType source     = 2; // 点赞来源类型
  int64                createTime = 3; // 点赞时间
}

message SkinData {
  option (gogoproto.equal)                  = true;
  uint32 skinID   = 1;
  int64  expireTS = 2;

}

message FreeRewardData{
  uint32 rewardID          = 1;
  int64  nextGetRewardTime = 2;
}

//抢车slot数据
message TruckSlotGoodsData{
  Asset  originalAsset = 1;//c出发时物品数量
  Asset  curAsset      = 2;
  uint32 robbedTimes   = 3; //被抢劫次数
}

message TruckRobbedData{
  int64           uid          = 1;
  int64           robTime      = 2;

  string          userName     = 4;
  uint32          quality      = 5;
  repeated Asset  robbedAssets = 6;
  string          btMsgID      = 7;
  repeated uint32 robbedSlot   = 8; // 被抢劫的slot
  uint64          fightPower   = 9; // 阵容战斗力
  Avatar          avatar       = 10; // 头像
  int64           guildID      = 11; // 公会ID
  string          guildName    = 12; // 公会名称
}

//抢车数据
message TruckData{
  option (optx.structuralVersion)          = 0;
  string                      ID           = 1[(optx.primaryKeyPriority) = 1]; //id
  int64                       sendTime     = 2; //发车时间
  int64                       endTime      = 3; //结束时间
  //每个slot的物品数据
  repeated TruckSlotGoodsData goods        = 4;
  string                      userName     = 5; //玩家名称
  double                      velocity     = 6; //速度
  repeated IntPos             roadPoints   = 7; //路线点
  Formation                   formation    = 8; //阵容
  uint32                      quality      = 9; //品质
  uint32                      ownerUID     = 10; //车主uid
  repeated TruckRobbedData    robbedList   = 11; //被抢劫数据
  uint64                      mapObjID     = 12; //卡车地图对象id
  uint32                      robbedTimes  = 13; //被抢劫次数
  int64                       guildID      = 14; // 公会ID
  string                      guildName    = 15; // 公会名称
  uint32                      refreshTimes = 16; // 刷新次数
  int64                       costTime     = 17; // 消耗时间
  uint32                      reserveId    = 18; // 预备役id
}

message TruckFightRecord{
  uint32 attackUID         = 1;
  string attackUserName    = 2;
  int64  attackTime        = 3;
  uint32 defendUID         = 4;
  string defendUserName    = 5;
  string truckID           = 6;
  string btMsgID           = 9;
  uint32 winUID            = 8;
  bytes  battleReportParam = 10;//战斗参数
  uint64 attackPower       = 11; // 攻击阵容战斗力
  uint64 defendPower       = 12; // 防守阵容战斗力
}


// 采集数据结构
message CollectData {
  uint64     targetObjID      = 1; // 采集目标对象ID
  uint32     mineCfgID        = 2; // 矿物配置ID
  uint32     mineLevel        = 3; // 矿物等级
  int64      startTime        = 4; // 采集开始时间
  double     collectSpeed     = 5; // 采集速度（每秒产出）
  int64      duration         = 6; // 要采集多久
  uint32     actualOutPut     = 7; // 实际采集量
  uint32     totalResource    = 8; // 矿点总资源量
  double     originalSpeed    = 9; // 采集车原始移动速度
  double     currentSpeed     = 10; // 采集车当前移动速度（带buff）
  double     userCollectSpeed = 11; // user原始采集速度
  uint64     radarTaskID      = 12; // 雷达任务ID
  msg.IntPos minePos          = 13[(gogoproto.nullable) = false]; // 矿坐标
  uint32     armyID           = 14; // armyID,挂定时器用
}
message UserCollectData{
  IntPos      pos         = 3[(gogoproto.nullable) = false];
  CollectData collectData = 4;
}
message OtherTruckData{
  string                      ID             = 1;
  int64                       sendTime       = 2;
  int64                       endTime        = 3;
  string                      userName       = 4;
  uint32                      quality        = 5;
  uint32                      otherTruckSlot = 6;//目标卡车所在slot
  uint64                      objID          = 7;
  int64                       ownerUID       = 8;
  int64                       guildID        = 9;
  string                      guildName      = 10;
  repeated TruckSlotGoodsData goods          = 11;
  uint32                      robbedTimes    = 12; //被抢劫次数
  uint64                      power          = 13; // 阵容战斗力
  repeated IntPos             roadPoints     = 14; //路线点

}
message ActPointData {
  uint64               scheduleID = 1;
  enumx.ActivityModule module     = 2;
  uint32               point      = 3;
}

message GroupDivKey{
  uint32 functionID  = 1;//(考虑配表，这样能通过function拿人数上下限 以及初始的组数)
  uint32 date        = 2;//(YYMMDD)
  uint32 serverGroup = 3;//(单服就是服ID了，跨服的时候会是一个groupID）
}

message GroupDivInfo{
  uint32         groupId = 1;//（如果用slice的index+1作为groupID，好像可以直接不需要这个字段了）
  uint32         count   = 2;// 已经多少人了
  repeated int64 uids    = 3;
}
message ActGroupInfo{
  uint32 groupLevel = 1; // 分段level
  uint32 groupID    = 2; // 排行榜分组ID
  uint32 groupDate  = 3; // 分组日期key，
}
message LevelGroupUnit{
  uint32                    level        = 1;
  map<int64, uint32>        uidToGroupId = 2;//（uid -> groupID映射）
  repeated msg.GroupDivInfo info         = 3;
}

// 英雄(Card)装备, wrapped by Item
message Equip {
  uint32 level         = 1; // 等级
  int64  resetCd       = 2; // 下次可重置时间
  uint32 exp           = 3; // 溢出经验
  uint32 cardTid       = 4; // 装备的卡牌id
  uint32 refineLv      = 5; // 专精等级
  int64  refineResetCd = 6; // 专精下次可重置时间
}

message EquipProduce {
  uint32 tid      = 1;
  int64  duration = 2;
  int64  endTs    = 3;
}

message CardWearingEquip {
  enumx.BodyPart pos        = 1; // 部位
  uint64         itemUniqId = 2; // 装备Item.id
}

message HuntTroopRobbedData{
  uint64          taskID       = 1; // 任务ID
  int64           robTime      = 2;
  string          userName     = 3;
  uint32          quality      = 4;
  repeated Asset  robbedAssets = 5;
  repeated uint32 robbedSlot   = 7; // 被抢劫的slot
  Avatar          avatar       = 8; // 头像
  int64           guildID      = 9; // 联盟ID
  string          guildName    = 10; // 联盟名称
  uint32          uid          = 11; // 玩家uid
  string          emoji        = 12; // 表情
}

message HuntTroopHelpedData{
  uint64 taskID     = 1; // 任务ID
  int64  helpedTime = 2; // 帮助时间
  string userName   = 3; // 玩家名称
  uint32 quality    = 4; // 品质
  Avatar avatar     = 7; // 头像
  int64  guildID    = 8; // 联盟ID
  string guildName  = 9; // 联盟名称
  uint32 uid        = 10; // 玩家uid
  string emoji      = 11; // 表情
}

message HuntTroopRecord{
  oneof record{
    HuntTroopRobbedData robbedData = 1;
    HuntTroopHelpedData helpedData = 2;
  }
}
message HuntTroopWantUserItem{
  uint32 uid        = 1; // 玩家uid
  int64  markedTime = 2; // 标记时间
}

message HuntTroopTask {
  uint64                       taskID          = 1; // 任务ID
  repeated Asset               assets          = 2; // 奖励
  repeated Asset               currentAssets   = 3; // 当前奖励
  int64                        sendTime        = 4;//派遣时间
  int64                        endTime         = 5;//结束时间
  string                       userName        = 6;//玩家名称
  uint32                       quality         = 7;//品质
  int64                        ownerUID        = 8;//任务发布者uid
  int64                        guildID         = 9;//联盟ID
  string                       guildName       = 10;//联盟名称
  repeated HuntTroopRobbedData robbedData      = 11; // 被抢劫数据
  uint32                       mapID           = 12; // 地图ID
  repeated uint32              HeroIDs         = 13; // 英雄ID
  uint32                       refreshTimes    = 14; // 刷新次数
  uint32                       cfgID           = 15; // 配置ID
  uint32                       robbedTimes     = 16; // 被抢劫次数
  uint32                       helpedTimes     = 17; // 被帮助次数
  repeated HuntTroopHelpedData helpedData      = 18; // 帮助数据
  bool                         isReward        = 19; // 是否领取奖励
  int64                        lastRefreshTime = 20; // 上次刷新时间
  IntPos                       pos             = 21; // 巡逻位置
  bool                         isSent          = 22; // 是否派遣
}

// obj move info
message MoveInfo {
  option (optx.withMask)          = true;  // 自动生成XXXWithMask

  double          speed           = 1; // 移动速度
  int64           startMS         = 2;
  IntPos          startPos        = 3 [(gogoproto.nullable) = false];         // 全程开始六边形坐标
  IntPos          endPos          = 4 [(gogoproto.nullable) = false];         // 全程结束六边形坐标
  Float64Pos      startFloat64Pos = 5 [(gogoproto.nullable) = false];  // 全程开始浮点数坐标
  Float64Pos      endFloat64Pos   = 6 [(gogoproto.nullable) = false];  // 全程结束浮点数坐标
  repeated IntPos pathList        = 7; // 路径列表
  IntPos          targetPos       = 8 [(gogoproto.nullable) = false]; // 目标点
  int64           endMS           = 9; // 预计结束时间
}
message CitizenQueue{
  enumx.CitizenQueue        queueId   = 1;
  repeated CitizenQueueInfo queueInfo = 2[(gogoproto.nullable) = false];
}

message CitizenQueueInfo{
  uint64              ID     = 1;
  uint32              cfgID  = 2;
  enumx.CitizenType   type   = 3;
  enumx.CitizenSource source = 4;
}

message RadarTaskData{
  uint64              taskID        = 1; // 任务ID
  int64               endTime       = 2; // 过期时间
  enumx.RadarTaskType taskType      = 3; // 任务类型
  uint32              cfgID         = 4; // 配置ID
  enumx.RadarTaskStatus status      = 5; // 任务状态
  uint64              mapObjID      = 6; // 地图对象ID
  IntPos              pos           = 7; // 任务位置
  uint32              showTag       = 8; // 界面点位
  uint32              ownerUID      = 9; // 任务拥有者UID
  uint64              guildID       = 10; // 任务拥有者联盟ID
  // bool                isDoing       = 11; // 是否正在执行
  // W3
  // int64               createTime    = 102; // 创建时间
  // bool                visible       = 104; // 是否可见
  // uint32              helpedUID     = 109; //帮助任务中被帮助对象UID
  // string              helpedName    = 110;//帮助对象中被帮助对象名字
  // Avatar              helpedAvatar  = 111;//帮助对象中被帮助对象头像
  // bool                strengthCuted = 112; // 是否消耗体力了
  // RadarTaskHelpInfo   helpInfo      = 115; // 帮助信息
  // msg.Reward          collectReward = 117; // 采集奖励
}

message RadarTaskRefreshInfo {
  uint32 cfgID           = 1;
  uint64 lastRefreshTime = 2;
  uint32 refreshTimes    = 3;
}

message RadarTaskHelpInfo {
  uint32 helperUID    = 1; // 帮助对象UID
  int64  helpTime     = 2; // 帮助时间
  string helperName   = 3; // 帮助对象名字
  Avatar helperAvatar = 4; // 帮助对象头像
  uint32 count        = 5; // 帮助计数
}

message RadarTreasureMember {
  uint32 uid           = 1; // 玩家uid
  int64  helpTime      = 2; // 帮助时间
  bool   rewardSent    = 3; // 奖励是否已发放
  bool   arrived       = 4; // 是否到达
  bool   isDouleReward = 5; // 是否已经领取双倍奖励
  uint32 armyID        = 6; // 军队ID
  bytes  armyData      = 7; // 军队数据
}

message UDigTreasureInfo {
  uint32 armyId      = 1; // 军队ID
  uint64 targetObjId = 2; // 地图对象ID
}

// 紧急搜救站数据
message EmergencyRescueData {
  repeated Uint32KV        dailyConsumedReserves  = 1;     // 当日死亡预备役（整数）
  repeated Uint32KV        accumulatedRewardPool  = 2;     // 累积奖励池（整数）
  int64                    lastDailyResetTs       = 3;                      // 上次跨天重置时间戳
  int64                    lastBuildingUpgradeTs  = 4;                 // 上次建筑升级时间戳
  repeated Uint32Float64KV dailyDeathsFloat       = 5;   // 当日死亡预备役（小数，用于累积）
  repeated Uint32Float64KV rewardPoolFloat        = 6;    // 奖励池浮点数（用于精确计算）
  uint32                   yesterdayMaxLimit      = 7;                   // 昨日返还数量上限（策划需求）
  double                   yesterdayRescueRate    = 8;                 // 昨日返还比例快照（用于跨天结算）
  double                   todayRescueRate        = 9;                     // 当日返还比例快照（Buff变更时更新）
  uint32                   todayMaxLimit          = 10;                      // 当日返还上限快照（Buff变更时更新）
  int64                    todaySnapshotUpdatedTs = 11;              // 当日快照最后更新时间（秒）
  int64                    todayGainReserves      = 12;              // 当日获取预备役（用于累积）
}
message CatalogInfo{
  uint32        ID      = 1;
  uint32        getStar = 2;
  enumx.Quality quality = 3;
}

// 联盟个人战争数据
message GuildPersonalWar {
  uint64            armyObjID    = 1;
  GuildWarCommander attacker     = 2; // 进攻方
  GuildWarCommander defender     = 3; // 防守方
  int64             expireTs     = 4; // 保底过期时间
  msg.IntPos        startPos     = 5[(gogoproto.nullable) = false]; // 开始坐标
  msg.IntPos        endPos       = 6[(gogoproto.nullable) = false]; // 目标坐标
  uint32            mapID        = 7;
  uint32            villageCfgID = 8;
  int64             endTs        = 9; // 行军结束时间
  uint32            mapCfgID     = 10;
}

message GuildWarCommander {
  int64  uid            = 1; // 玩家uid
  string name           = 2; // 玩家名称
  Avatar avatar         = 3; // 玩家头像
  uint64 power          = 4; // 玩家战力
  uint32 svrID          = 5; // 玩家服ID
  string guildShortName = 6; // 玩家公会简称
}
message GetRewardInfo{
  uint32 cfgID        = 1;
  bool   normalReward = 2;
  bool   seniorReward = 3;
}
// 聊天群成员
message ChatMember {
  int64 uid  = 1; // 玩家uid
  int64 time = 2; // 时间(申请/加入)
}

message QnrInfo {
  enumx.TaskStateType taskState  = 1;
  string              sourceID   = 2;
  int64               expireTs   = 3;
  uint32              scheduleID = 4;
}

message GroupMemberListInfo{
  int64                   groupID = 1;
  repeated msg.ChatMember members = 2;
  int64                   ownerID = 3;
}

message ClientCardPower {
  uint32 cardID                   = 1; // 兵卡ID
  uint64 barrackPowerofficerPower = 2; // 计算了各种外部加成后的战力 - 老版本等待删除
  uint64 barrackPowerOtherPower   = 3; // 其他系统加成的战力 - 老版本等待删除
}

message RentInfo{
  uint32 ID    = 1;
  int64  endTs = 2;
}

message SBuilding {
  uint32            id        = 1; // 建筑id
  uint32            level     = 2; // 建筑等级
  oneof Extend {
    CampBuilding      camp      = 11; // 兵营建筑
    WarehouseBuilding warehouse = 12; // 仓库建筑
  }
}


message SBuildingComponent {
  uint32               id                  = 1;    //组件id
  uint32               level               = 2;    //组件等级
  enumx.ComponentsType type                = 3;    //组件类型
  uint32               buildingId          = 4;    //所属建筑id
  uint32               assignedStaffID     = 5;    //分配的员工ID,0表示未分配
  int64                sliceElapsedSeconds = 6;  //上个时间片已经用掉的时间(秒)
  int64                sliceStartTime      = 7;    //下个时间片开始时间戳，等0说明员工生病或者从位置移除了(秒)
  enumx.AssetID        productID           = 8;    //生产组件时产出资源id
  double               NumValue            = 9;      //单个时间片产量(工作组件)或者给员工加属性值(加员工属性组件)
  double               TimeValue           = 10;     //单个时间片时长
  double               NumValue2           = 11;     //产量/属性值(目前用于病床，status2对应的值)
}

message BuildingQueue {
  uint32                  id            = 1; // 建筑id
  uint32                  level         = 2; // 建筑等级
  int64                   endTs         = 3; // 建筑结束时间戳
  enumx.BuildingQueueType queue_type    = 4; // 队列类型
  int64                   queueExpireTs = 5;   // 队列过期时间，0表示无限制
  int64                   startTs       = 6;    //队列使用开始时间
  int64                   duration      = 7; // 建筑持续时间（秒）
}

message StaffAttribute{
  double Satiety = 1; // 饱食度
	double Sleep   = 2; // 睡眠值
	double Mood    = 3; // 心情值
	double Comfort = 4; // 舒适度
}

message StaffAttributePush {
  uint32        staffId  = 1; //员工id
  StaffAttribute attr    = 2[(gogoproto.nullable) = false]; //员工属性
}

message Staff {
  uint32           id                          = 1;  // 员工id（流水ID，全局唯一）
  uint32           staffConfigId               = 2;  // 员工配置ID（对应s_staff_config表，可重用）
  uint32           age                         = 3;  // 年龄
  repeated uint32  traitIds                    = 4;  // 特性ID
  uint32           assignedWorkID              = 5;  // 分配的组件ID（工作组件）
  uint32           assignedMoodID              = 6;  // 分配的恢复心情组件ID（出生时固定）
  uint32           assignedComfortID           = 7;  // 分配的恢复心情组件ID（出生时固定）
  uint32           assignedMedicalID           = 8;  // 分配的病床位ID（生病时有效,病床不够，分配自己床位）
  uint32           assignedBedID               = 9;  // 分配的床位id,出生时固定
  int64            stateStartTime              = 10;  // 当前状态开始时间，服务器内部用(秒)
  int64            eatingEndTime               = 11; // 就餐结束时间（State=Eating时有效），服务器内部使用(秒)
  int64            sickRecoverTime             = 12; // 生病恢复时间（IsSick=true时有效）(秒)
  StaffAttribute   attributes                  = 13; // 员工主属性
  enumx.StaffState state                       = 14; // 当前状态，服务器内部使用
  bool             isDead                      = 15; // 是否死亡，服务器中用
  bool             isSick                      = 16; // 是否在生病状态
  double           satietyConsumptionNotSleep  = 17; // 饱食度消耗值，非睡眠期间
  double           satietyConsumptionInSleep   = 18; // 饱食度消耗值，睡眠期间
  double           sleepConsumptionNoWorkSite  = 19; // 睡眠值消耗值,没工位时
  double           sleepConsumptionHasWorkSite = 20; // 睡眠值消耗值，有工位时
  double           moodConsumptionNotSleep     = 21; // 心情值消耗值，非睡眠期间
  double           comfortConsumptionNotSleep  = 22; // 舒适度消耗值，非睡眠期间
  double           satietyLowerLimit           = 23; // 饱食度下限
  double           sleepLowerLimit             = 24; // 睡眠值下限
  double           moodLowerLimit              = 25; // 心情值下限
  double           comfortLowerLimit           = 26; // 舒适度下限
  int64            sickDuration                = 27; // 生病持续时间（IsSick=true时有效）(秒)
}

message Resolution{
  enumx.ResolutionType type      = 1;   //决议类型（作为主键）
  int64                startTime = 2;   //决议生效时间(秒)
  int64                endTime   = 3;   //决议失效时间(秒)
}

message ResolutionCooldown {
  enumx.ResolutionType type     = 1; 
  int64                cooldown = 2;
}

message SProduceValueClient {
  int64                       GameStartRealTime    = 1; // 游戏时间开始现实时间戳
  repeated SProducePlant      plants               = 2[(gogoproto.nullable) = false]; // 当前种植中列表
  int64                       globalProtestEndTime = 3; // 抗议结束时间
  uint32                      SelectedFoodMenuType = 4; //选择餐厅菜单，默认是1
  repeated Resolution         resolutions          = 5[(gogoproto.nullable) = false]; //决议
  repeated ResolutionCooldown resolutionCooldowns  = 6[(gogoproto.nullable) = false]; // 决议冷却时间（key: ResolutionType, value: 冷却结束时间戳）
}

message SProducePlant {
  uint32 plantId      = 1; // 种植田id
  int64  plantEndTime = 2; // 种植结束时间
  Asset  plantReward  = 3; // 预计种植产出
}

message SProduceExtra {
  int64                       gameStartRealTime    = 2; // 游戏开始时间
  int64                       globalProtestEndTime = 3; // 抗议结束时间
  uint32                      SelectedFoodMenuType = 4; //选择餐厅菜单，默认是1
  repeated Resolution         resolutions          = 5[(gogoproto.nullable) = false]; //决议
  repeated ResolutionCooldown resolutionCooldowns  = 6[(gogoproto.nullable) = false]; // 决议冷却时间
}

message SProduceSpeed {
  enumx.AssetID id    = 1;  //资源id
  uint32        speed = 2;  //每分钟产出量
}

message SProducePrice {
  enumx.AssetID id    = 1;  //资源id
  uint32        price = 2;  //单价
}

message CampBuilding {
  uint32             targetTid  = 1; // 最近一次目标部队Id
  uint32             sourceTid  = 2; //如果晋升，发原部队Id
  int64              startTs    = 3; // 开始时间
  int64              endTs      = 4; //结束时间
  uint32             trainNum   = 5; //训练数量，领取后清空
  repeated msg.Asset costAssets = 6; // 训练消耗，取消用
}

message WarehouseBuilding {
  uint32 times   = 1; // 今日领取次数
  uint32 cdEndTs = 2; // 冷却结束时间 > cdEndTs 表示可以领取  cdEndTs 和 当前不是同一天表示 times 重置为0
}

///////////////////////////////订单玩法////////////////////////////////////////
message DrugOrder {
  uint32           id         = 1; //订单 ID
  uint32           customerId = 2; //客户ID
  uint32           quality    = 3; //订单品质
  enumx.OrderState status     = 4; //订单状态
  int64            expireTime = 5; //订单过期时间
  uint32           contentId  = 6;
  uint32           slot       = 7;
  uint64           price      = 8; //价值多少Gold
  uint32           multi      = 9; //资源倍数
}

message DrugOrderItemTimes {
  enumx.AssetID id    = 1;  //资源id
  uint32        times = 2;  //资源订单次数
}

message DrugOrderHugeCnt {
  enumx.AssetID id    = 1;  //资源id
  uint32        cnt   = 2;  //剩余超额订单数
  uint64        amount = 3; // 触发时的资源数
  uint32        contentId = 4;
}


message DrugOrderSys {
  repeated DrugOrder orders      = 1; //当前订单列表
  uint32         lastId      = 2; //上次生成订单的 ID
  int64          sendTime    = 3; //发货时间/经销商出发时间
  int64          refreshTs   = 4; //下次刷新时间，0则不刷新
  uint32         reserveNum = 5; //储备订单数量
  int64          nextDealerTs = 6; //经销商刷新时间，到时间后可以发起一单
  int64          dealerEndTs = 7; // 经销商卖完时间
  repeated Asset dealerGoods = 8[(gogoproto.nullable) = false]; // 本单自动化交付商品
  uint64         dealerPrice = 9; // 本单自动化总Gold
  int64          dealerRewardTs = 10; //本单已领取奖励的时间
}

/////////////////////////////上位之路///////////////////////////////////////
message PowerRank {
  uint32          level          = 1; //等级
  uint32          orderNum       = 2; //完成订单
  uint64          gotGold        = 3; //获得金钱
  uint64          madeWeed       = 4;
  uint64          madeCola       = 5;
  uint64          madeCrystal    = 6;
  repeated uint32 passedStageIds = 7; //已过关卡id
}

// 战役数据
message Campaign {
  uint32                curStage       = 1; // 当前战役阶段
  repeated CampaignDrop drops          = 2; // 挂机奖励
  uint32                dropStage      = 3; // 挂机奖励阶段
  uint32                passCount      = 4; // 已经通关的战役数量
  int64                 lastRewardTs   = 5; // 上次领取挂机奖励的时间戳
  bool                  isRewardFull   = 6; // sp 离线奖励是否到上限
  uint32                curRewardStage = 16; // w3 当前已领取奖励阶段
}

// 战役挂机奖励
message CampaignDrop {
  enumx.CampaignDropType intervalType = 1; // 间隔类型
  int64                  lastUpdateTs = 2; // 上次更新时间戳
  repeated Asset         accAwards    = 3[(gogoproto.nullable) = false]; // 累积奖励
}
//////////////////章节/////////////////////////////
message ChapterInfo {
  uint32                   chapterId   = 1; // 章节ID
  enumx.ChapterRewardState rewardState = 2; // 章节奖励领取状态
  repeated Task            tasks       = 3; // 章节子任务
}

message TimedTask {
  uint32                     id          = 1; // id
  enumx.TimedTaskRewardState rewardState = 2; // 总奖励领取状态
  repeated Task              tasks       = 3; // 子任务
  int64                      endTime     = 4; // 任务结束时间
}

message RoleIncident {
  uint32          roleID = 1;  //角色id,可能是英雄或者npc
  repeated uint32 ids    = 2;  //触发的事件id
}

message Incident {
  repeated RoleIncident incident          = 1;
  repeated uint32       passedBattleIds   = 2;
  repeated uint32       finishedIncidents = 3;
}
