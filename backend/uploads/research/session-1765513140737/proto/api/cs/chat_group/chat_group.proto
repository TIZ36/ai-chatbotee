syntax = "proto3";
package chat_group;
import "msg/msg.proto";
import "third/github.com/go-proto-validators/validator.proto";
import "third/github.com/gogo/protobuf/gogoproto/gogo.proto";
import "enumx/enumx.proto";

option go_package = "verse/backend/pb/pb_chat_group";
option (gogoproto.goproto_getters_all) = false;

//------------------------------------------------------------------------------------------
message Up_Union {
  oneof body {
    option (validator.oneof) = {required: true};
    Up_CreateGroup     createGroup     = 1;
    Up_KickOut         kickOut         = 2;
    Up_Invite          invite          = 3;
    Up_JoinGroup       joinGroup       = 4; //只有在被邀请列表、邀请人还在群里并且没退过这个群才能立即加入
    Up_ExitGroup       exitGroup       = 5;
    Up_DisbandGroup    disbandGroup    = 6;
    Up_ApplyGroup      applyGroup      = 7;
    Up_GetApplyList    getApplyList    = 8;
    Up_DealOneApply    dealOneApply    = 9;
    Up_TransferOwner   transferOwner   = 10;
    Up_GetMemberList   getMemberList   = 11;
    Up_ChangeGroupName changeGroupName = 12;
  }
}

message Dn_Union {
  oneof body {
    Dn_CreateGroup     createGroup     = 1;
    Dn_KickOut         kickOut         = 2;
    Dn_Invite          invite          = 3;
    Dn_JoinGroup       joinGroup       = 4; //只有在被邀请列表、邀请人还在群里并且没退过这个群才能立即加入
    Dn_ExitGroup       exitGroup       = 5;
    Dn_DisbandGroup    disbandGroup    = 6;
    Dn_ApplyGroup      applyGroup      = 7;
    Dn_GetApplyList    getApplyList    = 8;
    Dn_DealOneApply    dealOneApply    = 9;
    Dn_TransferOwner   transferOwner   = 10;
    Dn_GetMemberList   getMemberList   = 11;
    Dn_ChangeGroupName changeGroupName = 12;
  }
}

// 创建群组
message Up_CreateGroup {
  string groupName = 1;
}
message Dn_CreateGroup {
  int64 groupID = 1;
  int64 createTs = 2;
  msg.ChatMember selfMember = 3;
}

// 踢出群组
message Up_KickOut {
  int64          groupID = 1;
  repeated int64  uids    = 2;//被踢的人UIDs
}
message Dn_KickOut {
}

// 邀请入群
message Up_Invite {
  int64         groupID = 1;
  repeated int64 uids    = 2;
}
message Dn_Invite {
  repeated int64 successIDs = 1;
  repeated int64 failIDs    = 2;
}

// 加入群组
message Up_JoinGroup {
  int64 groupID   = 1;
  int64  invitorID = 2;
}
message Dn_JoinGroup {
}

// 退出群组
message Up_ExitGroup {
  int64 groupID = 1;
}
message Dn_ExitGroup {
}

// 解散群组
message Up_DisbandGroup {
  int64 groupID = 1;
}
message Dn_DisbandGroup {
}

// 申请入群
message Up_ApplyGroup {
  int64 groupID   = 1;
  int64  invitorID = 2;
}
message Dn_ApplyGroup {
}

// 获取申请列表
message Up_GetApplyList {
  int64 groupID = 1;
}
message Dn_GetApplyList {
  repeated msg.ChatMember applyMembers = 1;
}

// 处理单个申请
message Up_DealOneApply {
  int64              groupID  = 1;
  int64               uid      = 2;
  enumx.ApplyDealType dealType = 3;
}
message Dn_DealOneApply {
}

// 转让群主
message Up_TransferOwner {
  int64              groupID  = 1;
  int64               uid      = 2;
}
message Dn_TransferOwner {
}
message Up_GetMemberList{
  repeated int64 groupID = 1;
}
message Dn_GetMemberList{
  repeated msg.GroupMemberListInfo infos = 1;
}

message Up_ChangeGroupName{
  int64 groupID = 1;
  string name    = 2;
}
message Dn_ChangeGroupName{
}