syntax = "proto3";
package sproduce;
import "msg/msg.proto";
import "enumx/enumx.proto";
import "enumx/csv_enumx.proto";
import "third/github.com/go-proto-validators/validator.proto";
import "third/github.com/gogo/protobuf/gogoproto/gogo.proto";

option go_package = "verse/backend/pb/pb_sproduce";
option (gogoproto.goproto_getters_all) = false;

// sproduce 资源产出

//------------------------------------------------------------------------------------------
message Up_Union {
  oneof body {
    option (validator.oneof) = {required: true};
    Up_GainProduceManual   gainProduceManual   = 1;  //第一人称获得产出
   
    Up_RefreshProduce      refreshProduce      = 4;  //刷新自动化产出
    Up_RequestOfflineRes   requestOfflineRes   = 5;  //请求离线产出
    Up_RequestProduceSpeed requestProduceSpeed = 6;  //请求资源生产速度
    Up_BeginPlant          beginPlant          = 7;  //请求种田
    Up_EndPlant            endPlant            = 8;  //结束种田
    Up_RequestProducePrice requestProducePrice = 9;  //请求资源单价
    Up_SelectCanteenMenu   selectCanteenMenu   = 10;  // 选择餐厅菜单
    Up_SelectResolution    selectResolution    = 11;  // 选择决议
  }
}

message Dn_Union {
  oneof body {
    Dn_GainProduceManual   gainProduceManual   = 1;
   
    Dn_RefreshProduce      refreshProduce      = 4;  //刷新产出
    Dn_RequestOfflineRes   requestOfflineRes   = 5;  //请求离线产出
    Dn_RequestProduceSpeed requestProduceSpeed = 6;  //请求资源生产速度
    Dn_BeginPlant          beginPlant          = 7;  //请求种田
    Dn_EndPlant            endPlant            = 8;  //结束种田 
    Dn_RequestProducePrice requestProducePrice = 9; 
    Dn_SelectCanteenMenu   selectCanteenMenu   = 10;  // 请求餐厅菜单
    Dn_SelectResolution    selectResolution    = 11;  // 选择决议
  }
}


//------------------------------------------------------------------------------------------

message Up_GainProduceManual {
  uint32 buildingID = 1;    //建筑id
}

message Dn_GainProduceManual {
  msg.Reward Reward = 1;    //产出
  msg.Cost   cost   = 2;    //消耗
}

message Up_RefreshProduce {
}

message Dn_RefreshProduce {
  repeated msg.Asset nowRes         = 1[(gogoproto.nullable) = false]; //当前资源
  int64              lastSettleTime = 2; // 上次结算奖励时间
}

message Up_RequestOfflineRes {
}

message Dn_RequestOfflineRes {
  repeated msg.Asset res            = 1[(gogoproto.nullable) = false]; //期间产出资源
  int64              lastSettleTime = 2; // 上次结算奖励时间
}

message Up_RequestProduceSpeed {
}

message Dn_RequestProduceSpeed {
  repeated msg.SProduceSpeed speed = 1; //资源产出效率
}

message Up_BeginPlant {
  uint32 buildingId = 1; //农田id
}

message Dn_BeginPlant {
  int64     endTime     = 1;  //收获时间戳
  msg.Asset plantReward = 2; // 预计种植产出
}

message Up_EndPlant {
  uint32 buildingId = 1; //农田id
}

message Dn_EndPlant {
  msg.Reward Reward = 1;    //产出
}

message Up_RequestProducePrice {
  repeated enumx.AssetID assetIDs = 1; // 商品资源
}

message Dn_RequestProducePrice {
  repeated msg.SProducePrice prices = 1; // 资源单价
}

message Up_SelectCanteenMenu {
  uint32 menuIndex = 1; // 菜单id
}

message Dn_SelectCanteenMenu {
  msg.SBuildingComponent canteen = 1; //餐厅
}

message Up_SelectResolution {
  enumx.ResolutionType resolutionType = 1; // 决议id
}

message Dn_SelectResolution {
  repeated msg.Staff              effectStaffs     = 1;
  repeated msg.SBuildingComponent effectComponents = 2; 
  msg.Reward                      rewards          = 3; //立即获取的资源
}