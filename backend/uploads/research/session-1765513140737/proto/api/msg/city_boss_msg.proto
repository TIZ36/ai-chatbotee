syntax = "proto3";
package msg;
option go_package = "verse/backend/pb";

import "optx/optx.proto";
import "enumx/csv_enumx.proto";
import "third/github.com/gogo/protobuf/gogoproto/gogo.proto";
import "third/github.com/go-proto-validators/validator.proto";
import "msg/msg.proto";
import "msg/battle_report.proto";
import "msg/battle_msg.proto";
option (gogoproto.goproto_getters_all) = false;

message CityBossData {
  CityBossDaily            dailyData           = 1; // （当日）日活动数据
  repeated CityBossHistory historyData         = 2; // 历史最佳（三个BOSS）
  repeated uint32          historyRewardCfgIDs = 3; // 已领历史奖励cfgID（CityBossHistoryReward.csv）
  CityBossDaily            lastDailyData       = 4; // （上次）日活动数据
}

message CityBossDaily {
  // 活动日数据
  int64              joinTS              = 1; // 当日加入时间
  enumx.CityBossType bossType            = 2; // boss类型
  IntPos             bossPos             = 3; // boss位置（citymap_actor获取坐标）
  uint32             atkCnt              = 4; // 当日攻击次数
  repeated uint32    rewardCfgIDs        = 5; // 已领取奖励cfgID（CityBossDailyReward.csv）
  uint64             maxDamage           = 6; // 当日最高伤害
  bool               crossDayRewardCheck = 7; // 已检查（昨日）奖励发放
  uint32             mapID               = 8; // 当前所在地图ID
  uint64             objID               = 9; // 世界BOSS objID
  uint32             mapCfgID            = 10; // 地图cfgID
}

message CityBossHistory {
  // 单个BOSS历史记录
  enumx.CityBossType               bossType      = 1; // boss类型
  uint64                           maxDamage     = 2; // 最高伤害
  MailBattleReportContent          bestBattle    = 3; // 最佳战报
  repeated MailBattleReportContent recentBattles = 4; // 最近10场战报
}

message CityBossPlayerCache {
  option (optx.structuralVersion)            = 0;
  string                  key     = 1[(optx.primaryKeyPriority) = 1]; // 玩家信息key
  int64                   uid     = 2; // 玩家UID
  repeated CityBossLegion legions = 3; // 阵容详情
}
